// PARTICLE SYSTEM
const canvas = document.getElementById("particleCanvas");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let particles = [];

class Particle {
    constructor(){
        this.x = Math.random()*canvas.width;
        this.y = Math.random()*canvas.height;
        this.size = Math.random()*3+1;
        this.speedY = Math.random()*1+0.5;
    }

    update(){
        this.y -= this.speedY;
        if(this.y < 0){
            this.y = canvas.height;
            this.x = Math.random()*canvas.width;
        }
    }

    draw(){
        ctx.fillStyle="rgba(255,0,128,0.4)";
        ctx.beginPath();
        ctx.arc(this.x,this.y,this.size,0,Math.PI*2);
        ctx.fill();
    }
}

for(let i=0;i<120;i++){
    particles.push(new Particle());
}

function animateParticles(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    particles.forEach(p=>{
        p.update();
        p.draw();
    });
    requestAnimationFrame(animateParticles);
}
animateParticles();

// MAIN INTERACTIONS
const startBtn = document.getElementById("startBtn");
const treeSection = document.querySelector(".tree-section");
const root = document.getElementById("root");
const leaves = document.getElementById("leaves");
const messageSection = document.getElementById("messageSection");
const typedText = document.getElementById("typedText");

const messages = [
"Hey, youðŸ’•",
"Happy birthday ðŸŽˆ",
"May God bless youðŸ€",
"And bring you more happiness ðŸ’—",
"Just saying you are pretty... pretty awesomeâ£ï¸",
"Sending good vibes and maybe a... winkðŸ˜",
"Hope you have a great day todayðŸ¤žðŸ»",
"Luv yaaðŸ«¶ðŸ»ðŸ˜"
];

function typeMessage(index=0){
    if(index >= messages.length) return;

    let p = document.createElement("p");
    typedText.appendChild(p);

    let i=0;
    let text = messages[index];

    let typing = setInterval(()=>{
        p.innerHTML += text.charAt(i);
        i++;
        if(i === text.length){
            clearInterval(typing);
            setTimeout(()=>typeMessage(index+1),700);
        }
    },40);
}

startBtn.addEventListener("click",()=>{

    startBtn.style.display="none";

    setTimeout(()=>{
        treeSection.style.bottom="0";
        root.style.height="70px";
    },500);

    setTimeout(()=>{
        for(let i=0;i<8;i++){
            let leaf=document.createElement("div");
            leaf.className="leaf";
            leaf.innerHTML="ðŸ’–";
            leaves.appendChild(leaf);
        }
        leaves.style.opacity="1";
    },2000);

    setTimeout(()=>{
        messageSection.style.opacity="1";
        typeMessage();
    },4000);
});